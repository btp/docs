<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Graphic Map Generation</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="schema.DC" href="http://purl.org/dc/terms/"><meta name="DC.Type" content="concept"><meta name="DC.Title" content="Graphic Map Generation"><meta name="abstract" content="The map-driven processing generates an Ant script that copies graphics from their source locations to the output location."><meta name="description" content="The map-driven processing generates an Ant script that copies graphics from their source locations to the output location."><meta name="DC.Relation" scheme="URI" content="../../../user_docs/d4p-users-guide/introduction-chapter.html"><meta name="DC.Relation" scheme="URI" content="../../org.dita4publishers.epub/epub-plugin/generating-epubs.html"><meta name="DC.Relation" scheme="URI" content="map-driven-processing.html"><meta name="DC.Relation" scheme="URI" content="map-driven-processing.html"><meta name="DC.Relation" scheme="URI" content="index-generation.html"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="conceptId"><script type="text/javascript">var d4p = {"relativePath":"..\/..\/..\/","dev":false,"debug":false,"draft":false,"nextTopicHref":"repo\/org.dita4publishers.html2\/html2-plugin\/html2-toolkit-plugin.html","previousTopicHref":"repo\/org.dita4publishers.common.mapdriven\/map-driven-processing\/index-generation.html","root":false,"topic":{"chunked":""},"map":{"title":"  DITA For Publishers User Guide  ","chunked":false},"search":{"minlength":2},"l":{"searchPageHeading":"Search Results","close":"Close"}}</script><link rel="stylesheet" type="text/css" media="screen, projection" href="../../../themes/dita-d4p-classic/css/style.css"><link rel="stylesheet" type="text/css" media="screen, projection, print" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,
          
          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,
          
          // Optional callback... myCallback(i, width)
          callback: doc_resize,
          
          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  = mobile.css',
             // medium (size-1, size-2)
            '760px  to 980px  = 720.css',
            '980px  to 1270px = 960.css',
             // large (size-3, size-5)
            '1270px to 1600px = 1200.css',
            '1600px to 1940px = 1560.css',
             // extra large (size-6)
            '1940px to 2540px = 1920.css',
            '2540px           = 2520.css'
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script><script type="text/javascript" src="../../../themes/dita-d4p-classic/js/script.js"></script></head><body class="en-us dita-d4p-classic centered navigation-default"><div id="d4h5-main-container" class="container_12" role="application"><ul id="page-links" class="hidden"><li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li><li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li><li><a id="skip-to-footer" href="#footer">Skip to footer</a></li></ul><header role="banner" aria-labelledby="publication-title" class="hide-for-small"><div class="grid_8"><h1 id="publication-title">  DITA For Publishers User Guide  </h1></div><section class="grid_4 search-box"><form id="search" role="search"><div class="form-group"><input id="search-text" type="text" autocomplete="off" class="form-control" placeholder="Search"></div></form></section><secion class="clearfix"></secion></header><div id="d4h5-section-container" class="grid_12"><nav id="local-navigation" class="grid_4 alpha omega" role="navigation" aria-label="Main navigation"><div id="nav-content"><ul><li><a href="../../../index.html">Table of Contents</a></li><li><a href="../../../user_docs/d4p-users-guide/frontmatter/coverpage.html">DITA For Publishers User Guide</a></li><li><a href="../../../user_docs/d4p-users-guide/topics/about-this-book.html">About This Book</a></li><li class="collapsible collapsed"><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes.html">Release Notes</a><ul><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-1.0.0.html">Release Notes: Version 1.0.0RC00 (github version)</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.19.html">Release Notes: Version 0.9.19RC12</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.18.html">Release Notes: Version 0.9.18</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.16.html">Release Notes: Version 0.9.16</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.15.html">Release Notes: Version 0.9.15</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.14.html">Release Notes: Version 0.9.14</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.13.html">Release Notes: Version 0.9.13</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.12.html">Release Notes: Version 0.9.12</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.11.html">Release Notes: Version 0.9.11</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.10.html">Release Notes: Version 0.9.10</a></li><li><a href="../../../user_docs/d4p-users-guide/release-notes/release-notes-0.9.9.html">Release Notes: Version 0.9.9</a></li></ul></li><li><a href="../../../user_docs/d4p-users-guide/topics/intro-to-d4p.html"><span class="enumeration enumeration0">Chapter&nbsp;1. </span>Introduction to DITA For Publishers</a></li><li class="collapsible active"><a href="../../../user_docs/d4p-users-guide/introduction-chapter.html"><span class="enumeration enumeration0">Part&nbsp;I. </span>The DITA For Publishers Open Toolkit Plugins</a><ul><li><a href="../../../user_docs/d4p-users-guide/tasks/plugin-installation.html"><span class="enumeration enumeration1">Chapter&nbsp;2. </span>Installing the Toolkit Plugins</a></li><li class="collapsible collapsed"><a href="../../org.dita4publishers.epub/epub-plugin/generating-epubs.html"><span class="enumeration enumeration1">Chapter&nbsp;3. </span>Generating EPUBs and Kindle Books from DITA Content</a><ul><li><a href="../../org.dita4publishers.epub/epub-plugin/generating-epubs-from-oxygen.html">Generating EPUBs From OxygenXML</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/generating-kindle-books-from-oxygen.html">Generating Kindle Books From OxygenXML</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/using-custom-css.html">Using Custom CSS Style Sheets</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/creating-cover-graphics.html">Creating Cover Graphics and Covers</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/creating-opf-metadata.html">Creating Arbitrary EPUB OPF Metadata</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/overriding-base-processing.html">Implementing Overrides for Common Processing</a></li><li class="collapsible collapsed"><a href="../../org.dita4publishers.epub/epub-plugin/epub-transtype-parameters-ref.html">EPUB and Kindle Transformation Parameters</a><ul><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-argsCssOutputDir.html">args.css.output.dir Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-coverGraphicFile.html">cover.graphic.file Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-d4pMaxNavDepth.html">d4p.max.nav.depth Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-d4pMaxTocDepth.html">d4p.max.toc.depth Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-epubIncludeAutoRellinks.html">epub.exclude.auto.rellinks Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-epubPubidUriStub.html">epub.pubid.uri.stub Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-epubTempDir.html">epub.temp.dir Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-imagesOutputDir.html">images.output.dir Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-kindleGenExecutable.html">kindlegen.executable Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-titleOnlyTopicClassSpec.html">title.only.topic.class.spec Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-titleOnlyTopicTitleClassSpec.html">title.only.topic.title.class.spec Ant parameter</a></li><li><a href="../../org.dita4publishers.epub/epub-plugin/reference/ant-parm-topicsOutputDir.html">topics.output.dir Ant parameter</a></li></ul></li></ul></li><li class="collapsible active"><a href="map-driven-processing.html"><span class="enumeration enumeration1">Chapter&nbsp;4. </span>Map-Driven Processing</a><ul><li><a href="map-driven-processing.html">Map-Driven Processing</a></li><li><a href="enumeration.html">Numbering Things: Collected Data and Enumeration</a></li><li><a href="index-generation.html">Index Generation</a></li><li class=" active"><a href="graphic-map-generation.html" class=" selected">Graphic Map Generation</a></li></ul></li><li class="collapsible collapsed"><a href="../../org.dita4publishers.html2/html2-plugin/html2-toolkit-plugin.html"><span class="enumeration enumeration1">Chapter&nbsp;5. </span>HTML2 Plugin</a><ul><li class="collapsible collapsed"><a href="../../org.dita4publishers.html2/html2-plugin/understanding-html2-transforms.html">Understanding the HTML2 Transformations</a><ul><li><a href="../../org.dita4publishers.html2/html2-plugin/overall-process-flow.html">Overall HTML Generation Process Flow</a></li><li><a href="../../org.dita4publishers.html2/html2-plugin/customizing-enumeration.html">Extending and Customizing Enumeration Processing (Numbering)</a></li></ul></li><li class="collapsible collapsed"><a href="../../org.dita4publishers.html2/html2-plugin/html2-transtype-parameters-ref.html">HTML2 Transformation Parameters</a><ul><li><a href="../../org.dita4publishers.html2/html2-plugin/reference/ant-parm-fileOrganizationStrategy.html">html2.file.organization.strategy Ant parameter</a></li><li><a href="../../org.dita4publishers.html2/html2-plugin/reference/ant-parm-generateDynamicToc.html">html2.generate.dynamic.toc Ant parameter</a></li><li><a href="../../org.dita4publishers.html2/html2-plugin/reference/ant-parm-generateFrameset.html">html2.generate.frameset Ant parameter</a></li><li><a href="../../org.dita4publishers.html2/html2-plugin/reference/ant-parm-generateStaticToc.html">html2.generate.static.toc Ant parameter</a></li></ul></li></ul></li></ul></li><li><a href="../../../user_docs/d4p-users-guide/backmatter/colophon.html">Colophon</a></li><li><a href="../../../generated-index.html">Index</a></li></ul></div></nav><div id="d4h5-main-content" class="grid_8 alpha omega"><article><nav id="content-toolbar" class="toolbar hide-for-small"><div class="familylinks"><div xmlns:htmlutil="http://dita4publishers.org/functions/htmlutil" class="parentlink"><a href="../../../user_docs/d4p-users-guide/introduction-chapter.html" title="The DITA For Publishers Open Toolkit Plugins"><span class="fi fi-arrow-up"></span><span class="screen-reader">The DITA For Publishers Open Toolkit Plugins</span></a></div><div xmlns:htmlutil="http://dita4publishers.org/functions/htmlutil" class="previouslink"><a href="../../org.dita4publishers.epub/epub-plugin/generating-epubs.html" title="Generating EPUBs and Kindle Books from DITA Content"><span class="fi fi-arrow-left"></span><span class="screen-reader">Generating EPUBs and Kindle Books from DITA Content</span></a></div><div xmlns:htmlutil="http://dita4publishers.org/functions/htmlutil" class="nextlink"><a href="map-driven-processing.html" title="Map-Driven Processing"><span class="fi fi-arrow-right"></span><span class="screen-reader">Map-Driven Processing</span></a></div></div><div class="familylinks"><div xmlns:htmlutil="http://dita4publishers.org/functions/htmlutil" class="parentlink"><a href="map-driven-processing.html" title="Map-Driven Processing"><span class="fi fi-arrow-up"></span><span class="screen-reader">Map-Driven Processing</span></a></div><div xmlns:htmlutil="http://dita4publishers.org/functions/htmlutil" class="previouslink"><a href="index-generation.html" title="Index Generation"><span class="fi fi-arrow-left"></span><span class="screen-reader">Index Generation</span></a></div></div></nav><section id="page"><div class="page concept    topic topic concept concept "><a name="conceptId" id="conceptId" class="anchor"></a>
 <h1 class="title topictitle1">Graphic Map Generation</h1>
 
  
 <div class="body conbody"><p class="shortdesc">The map-driven processing generates an Ant script that copies
    graphics from their source locations to the output location.</p>
   <p class="p">Because the map-driven processing allows you to change the output
      organization of the generated files, references to graphics in the source
      DITA XML do not translate directly to graphic references in the output. To
      address this, the map-driven process finds all graphic references in the
      input data (including graphics referenced from DITAVAL files), constructs
      an input-to-output location map, and generates an Ant script that copies
      the source graphics to their output location. As part of output
      generation, references to graphics are rewritten to reflect their output
      location.</p>
    <p class="p">The graphic map generation is implemented in the module
      <span class="ph filepath">org.dita4publishers.common.xslt/xsl/map2graphicMap.xsl</span>.
      You can extend the default processing to provide mapping for any graphics
      that are not represented by normal DITA markup, such as covers determined
      by run-time parameters or branding graphics defined separately or
      whatever.</p>
    <p class="p">The map generation is done in two phases. </p>
    <div class="p">The first phase is mode "get-graphic-refs", which is applied to the map,
      all topics, and the DITAVAL file, if specified. It results in a set of
      graphic reference elements of the
      form:<pre class="pre codeblock"> &lt;gmap:graphic-ref 
   href="{absoluteUrl of source graphic}" 
   filename="{filename of the graphic}"
 /&gt;</pre></div>
    <p class="p">One <code>&lt;graphic-ref&gt;</code> element should be generated for each
      graphic reference in the source.</p>
    <div class="p">The second phase processes all the <code>&lt;graphic-ref&gt;</code>
      elements to determine the set of unique graphics used. This process
      results in the graphic map, which looks like
      this:<pre class="pre codeblock">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;gmap:graphic-map
  xmlns:xd="http://www.oxygenxml.com/ns/doc/xsl"
  xmlns:gmap="http://dita4publishers/namespaces/graphic-input-to-output-map"&gt;
  &lt;gmap:graphic-map-item
    input-url="/Users/ekimber/workspace_37/dita4publishers_0.9.19_clean/sample_data/flagging-test/ditavals/graphics/windows-icon.jpg"
    output-url="file:/Users/ekimber/workspace_37/dita4publishers_0.9.19_clean/sample_data/flagging-test/html5/images/windows-icon.jpg"
    id="d82e1"/&gt;
  &lt;gmap:graphic-map-item
    input-url="file:/Users/ekimber/workspace_37/dita4publishers_0.9.19_clean/sample_data/flagging-test/ditavals/graphics/windows-icon.jpg"
    output-url="file:/Users/ekimber/workspace_37/dita4publishers_0.9.19_clean/sample_data/flagging-test/html5/images/windows-icon-2.jpg"
    id="d82e2"/&gt;
  &lt;gmap:graphic-map-item
    input-url="file:/Users/ekimber/workspace_37/dita4publishers_0.9.19_clean/sample_data/flagging-test/ditavals/graphics/osx-icon.jpg"
    output-url="file:/Users/ekimber/workspace_37/dita4publishers_0.9.19_clean/sample_data/flagging-test/html5/images/osx-icon.jpg"
    id="d82e3"/&gt;
&lt;/gmap:graphic-map&gt;</pre></div>
    <p class="p">The graphic map may then be passed as a parameter to subsequent
      processing and is used to generate the
      <span class="ph filepath">copy-graphics.xml</span> Ant script (mode
      "generate-graphic-copy-ant-script" implemented in module
      <span class="ph filepath">org.dita4publishers.common.xslt/xsl/graphicMap2AntCopyScript.xsl</span>).</p>
    <p class="p">Image URLs are rewritten during initial topic processing using the mode
      "href-fixup" implemented in the module
      <span class="ph filepath">org.dita4publishers.common.xslt/xsl/topicHrefFixup.xsl</span>.
      URLs are rewritten to reflect the output location of the images so that
      the default HTML output processing will automatically construct the
      correct URL for the images.</p>
 </div>
<div class="related-links"></div>
<footer id="topicsNPLinks"><div id="footer_previous"><a xmlns:htmlutil="http://dita4publishers.org/functions/htmlutil" href="../../../repo/org.dita4publishers.common.mapdriven/map-driven-processing/index-generation.html" class="previous" rel="internal">Index Generation</a></div><div id="footer_next"><a xmlns:htmlutil="http://dita4publishers.org/functions/htmlutil" href="../../../repo/org.dita4publishers.html2/html2-plugin/html2-toolkit-plugin.html" class="next" rel="internal">HTML2 Plugin</a></div></footer></div></section></article><div class="clear"></div></div><div class="clearfix"></div></div><div class="clearfix"></div><div id="footer-container" class="grid_12"></div></div></body></html>